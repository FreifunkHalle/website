<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
     "http://www.w3.org/TR/html4/loose.dtd">

<?php require_once("functions.php"); ?>

<HTML>
<HEAD>
  <TITLE>Freifunk Halle - IPv4-Nachbarn</TITLE>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <?php include("../header-html.php"); ?>
</HEAD>
<BODY>
<?php include_once("../header.php"); ?>

  <div id="content">
<div class="teaser">
<h2> Knotenliste </h2>
  <table>
    <tr>
      <th> IP</th>
      <th> Adresse</th>
      <th> Tunnellink </th>
      <th> Status </th>
    </tr>

<?php 
  $response = str_replace("\ "," ", str_replace("\.",".", get_web_page("http://www.freifunk-halle.net/Tools/WikiJSON.ashx")));
  $data = json_decode($response,true);
  $topo = $data["topo"];
  $color=false;

  foreach ( $topo as $node)
  {
	$ip = $node["ipv4"];
        $address = $node["addr"];
	$online=false;
	if (time()-$node["stime"]< 7200) $online=true;
        if ($color) $colorstr="class=\"rowstyle-1\"" ; else $colorstr="";

        echo "<tr ".$colorstr."><td><a href=\"http://".$ip."/cgi-bin-nodes.html\">".$ip."</a></td>"
        ."<td>".$address."</td>"
        ."<td>".($node["hastunnellink"]?"<b>Ja</b>":"Nein")."</td>"
        ."<td bgcolor=\"".($online?"#00cc00":"#bb3333")."\">".($online?"online":"offline")."</td>";
        $color=!$color;
  }
?>
  </table>
</div class="teaser">
  </div id="content">

  <?php require_once("../footer.html"); ?>
</BODY>
</HTML>
